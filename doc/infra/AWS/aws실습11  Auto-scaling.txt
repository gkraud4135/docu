1.EC2 관리콘솔에서 인스턴스의 시작템플릿을 클릭합니다.
화면에서 주황색  시작템플릿 단추를 클릭합니다.

2.시작 템플릿 생성화면에서 시작 템플릿 이름을 AWS-template 이라 입력하고 
템플릿 버전 설명에 aws-autosaling template이라 입력후 EC2 Auto Scaling 지침 제공체크박스를 체크합니다.

3.AMI -필수 란에는 두번째 표시되는 AMI인 Amazon Linux 2 AMI (HVM), SSD Volume Type 선택하고 인스턴스유형에는 t2.micro를 선택합니다.
이실습에서는 실습용web서버를 올리는 것으로 SSH접근은 하지 않을 것이기에 keypair는 사용하지 않을것입니다.키 페어(로그인)부분은 그대로 둡니다.

4.보안 그룹은 이전 실습에서 만든 aws-elb-sg-webserver를 선택

5.리소스 태그에서 태그추가 단추를 클릭 후 키부분에 name입력, 값부분을 클릭하여 나타나는 aws-elb-sg-webserver 선택후 aws-webserver로 수정입력  리소스유형에 인스턴스와 볼륨 선택하여 표시되면 화면 하단에 시작템플릿 생성 단추 클릭하고 다음화면에서 시작템플릿 보기단추를 클릭하면 생성완료화면이 나타나고 시작템플릿보기 단추를 클릭하여 AWS-ASG 시작템플릿이 표시되는것을 확인한다

6.AUTO SCALING메뉴에서 Auto Scaling Groups을 클릭하여 화면상단의  Auto Scaling 그룹생성 주황색단추를 클릭하여 시작 템플릿 또는 구성 선택화면이 다시 표시되면 Auto Scaling 그룹 이름에 "aws-asg"입력
시작 템플릿의 화살표를 클릭하여 이전에 만든 AWS-template 표시되면 선택하고 하단의 다음단추를 클릭합니다

7.설정 구성화면에서 구매 옵션 및 인스턴스 유형이 시작 템플릿 준수로 선택되어 표시되는지 확인


8.설정 구성화면 에서 네트워크섹션의 VPC는 10.0.0.0.16인 ELB-VPC선택
서브넷에서 이전실습시 작성한 subnet-2a와 subnet-2c선택후 표시확인후 다음단추 클릭

9.고급 옵션 구성화면에서 로드 밸런싱 활성화 체크박스를 선택합니다(이로서 로드밸런서를 통해 EC2인스턴스를 시작할 수 있습니다)
로드밸런서를 연결하면 인스턴스 시작시 자동으로  등록됩니다

10. 로드 밸런서의 대상 그룹 선택의 화살표를 눌러 aws-ELB-Webserver-Targetgroup을 선택합니다.


11.화면 하단의 추가 설정 - 선택 사항에 CloudWatch 내에서 그룹 지표 수집 활성화 체크박스를 클릭하여 선택하고 다음단추를 클릭합니다.

12.그룹 크기 및 조정 정책 구성화면에서 그룹 크기 - 선택 사항을 용량2,최소용량2,최대용량4로 입력합니다.

13.조정 정책 - 선택 사항에서 대상 추적 조정 정책을 선택합니다.대상값은 30으로 입력합니다(CPU사용률30을기준으로EC2 인스턴스개수를늘이거나줄이게 됩니다.)다음을 클릭합니다.

14.알림 추가 화면에서 다음을 클릭합니다.

15.태그 추가화면에서 태그추가 단추를 클릭하고 키입력부분에 name을 입력 값입력부분에 aws webserver 입력후 다음을 클릭

16,검토 화면이 표시되면 맨 하단에 Auto Scaling 그룹단추를 클릭

17.AWS-template 을 기반으로 한 aws-asg 이름의 auto-scaling그룹이 표시되는 것을 확인

[부하테스트]
18.로드밸런서를 클릭하고 생성된 AWSLab-ELB 로드밸런서의 설명탭에서
DNS이름을 복사하여 브라우저에서 붙여넣기를 수행하여 웹서버에 접속한다.

19.접속된 웹서버의 화면에서 로드테스트를 클릭하면 해당웹서버에 100%의 부하가 발생하여 현재cpu부하가 100%로 표시된다

20.관리콘솔에서 Auto Scaling 그룹을 클릭하여 생성된 aws-asg Auto Scaling 그룹을 클릭하고 활동 탭 선택하여 화면 하단의 작업기록 내역을 검토해본다.(부하가 특정인스턴스에 집중되어 자동으로 오토스케일링이 수행된다)
내용은 아래와 유사할 것이다

"2020-10-06T16 : 52 : 27Z에 사용자 요청이 원하는 용량을 0에서 2로 변경하는 AutoScalingGroup을 생성했습니다. 2020-10-06T16 : 52 : 50Z에 원하는 용량과 실제 용량의 차이에 대한 응답으로 인스턴스가 시작되었습니다. 용량을 0에서 2로 늘립니다."





참고:Auto-scaling을 실습하려면 로드밸런싱메뉴의 대상그룹을 클릭하여 이전에 만들어 등록했던 aws-ELB-Webserver-Targetgroup을 클릭하고 aws-elb-sg-webserver1과 aws-elb-sg-webserver2 인스턴스를 선택하고 Deregister단추를 클릭하여 등록목록에서 제거합니다